---
title: "Final-Paper"
author: "Lily Geiser"
date: "2023-12-14"
output:
  pdf_document: default
  html_document: default
---

The World Health Organization: Factors that Influence Life Expectancy
2015

By Lily Geiser, Angel Baeza, and Hannah Ashburn

I. Introduction

The World Health Organization (WHO) is a specialized agency under the United Nations, its parent organization. Established on April 7, 1948, the WHO merged the assets, personnel, and duties of the League of Nations Health Organization with Paris's Office International d'Hygi√®ne Publique, which included the International Classification of Diseases (ICD).

While their primary objective is to help ensure the global population attains the highest level of health possible, the WHO has also been actively involved in gathering a wide range of data from member countries. This data, most of which is publically available, has been used to conduct a variety of research projects in hopes of solving the world's most pressing global health challenges. The metrics collected by the WHO's Global Health Observatory (GHO) include a broad range of health indicators such as mortality, disease prevalence, health system performance, and other social determinants of health. They also collect more qualitative data through the World Health Survey, which collects voluntarily submitted insights into people's perceived access to healthcare, health-related behaviors, and other personal information that would not be available otherwise. 

By analyzing this data, not only can we add to a growing body of research, we can contribute our findings towards creating a better understanding of health trends and disparities across the globe. Furthermore, any remarkable trends identified in this data could have significant implications on policy development, resource allocation, and disease prevention and control-- all of which are vastly important areas. Such findings could bolster and facilitate efforts to increase the global population's quality of life and overall life expectancy, generating a significant impact on society as we know it. 

II. Model Creation and Analysis: Full Model

The first model we created was a multiple regression model using data from only the year 2015. Our goal in creating this model is to see how life expectancy is correlated with the other variables in our dataset. We used data from only 2015 so that the different life expectancies reported varied by country alone, not by country and. year. Further, this model could then be applied to other years to verify that its accuracy; if this model is not accurate from year to year, this could imply to us that there are other confounding variables not included in the data, or that the explanatory factors could have varying impacts by country.

The full model we created it shown below. As discussed, the independent variable is life expectancy; all other variables in the dataset are used, excluding country (as each life expectancy comes from a different country, therefore this variable could predict the life expectancy with 100% accuracy), year (as all data is from 2015), and Economy_status_Developing (as this is simply the reverse of Economy_status_Developed, which is included). Our null hypothesis associated with this model is that none of the explanatory variables have any correlation with life expectancy (i.e. that their coefficients equal 0). Our alternative hypothesis is that at least one of the explanatory variables has a coefficient that does not equal zero. For this model and all models used throughout this report, we will be using a significance level of 0.05.

```{r full_model}
#importing data and creating 2015 dataset
data <- read.csv("cleandata.csv")
data.2015 <- data[data$Year == 2015, ]

#creating regression model and outputting summary data
reg_2015 <- lm(Life_expectancy~as.factor(Region)+Infant_deaths+Under_five_deaths+
                 Adult_mortality+Alcohol_consumption+Hepatitis_B+Measles+BMI+Polio+
                 Diphtheria+Incidents_HIV+GDP_per_capita+Population_mln+
                 Thinness_ten_nineteen_years+Thinness_five_nine_years+Schooling+
                 as.factor(Economy_status_Developed), data=data.2015)
print(summary(reg_2015))
```

There are several insights we can obtain from the above model. Firstly, we can say that this model appears to be a good fit and does an excellent job of predicting life expectancy. Firstly, we can observe that the p-value associated with the overall model is extremely close to 0, at less than 2.2e-16. This tells us that we can certainly reject our null hypothesis and accept the alternative hypothesis. Further, we can see that the multiple R-squared value is 0.9781; this is a value incredibly close to 1, which tells us that nearly all of the variation in life expectancy can be explained by the variation in the explanatory variables.

If we look at the coefficients associated with the variables, we will observe that multiple of them are statistically significant; specifically, the regions Central America and the Caribbean, and South America; the under five mortality rate; adult mortality; HIV incidence; GDP per capita; and whether the country is classified as Developed or Developing all have statistically significant coefficients. The coefficient associated with the intercept is also significant. This tells us there is evidence that these variables specifically have nonzero coefficents; there is not sufficient evidence to come to this conclusion for the other variables, as they all have associated p-values of greater than 0.05. 

III. Explanatory Variable Correlation and a Reduced Model

While our model above appears to be an incredibly good fit, we wanted to see if this model could be improved upon with a reduced model. Firstly, we wanted to see whether any of the variables above were highly correlated. To accomplish this, we first obtained the associated VIF values:

```{r vif}
library(car)
print(vif(reg_2015))
```

As we can see, some of these variables have incredibly high VIF values; specifically, Region, Infant_deaths, Under_five_deaths, Hepatitis_B, Diphtheria, Thinness_ten_nineteen_years, and Thinness_five_nine_years all have GVIF values above 10. It is important to note that the adjusted GVIF values found in the righthand column are signficantly lower (for example, due to the multiple degrees of freedom in the Region variable, the adjusted GVIF is substantially lower). However, our goal in creating the reduced model was to reduce multicollinearity as much as possible. 

Our next step was to determine which specific variables are closely related to each other. The code to accomplish this is below; the output of this code is which cells of the covariance matrix have values greater than 0.8, and the associated variables. Categorical variables were excluded from the generated covariance matrix.

```{r covar}
matrix <- cor(data.2015[, sapply(data.2015, is.numeric)])
high_correlation_indices <- which(matrix > 0.8 & matrix < 1, arr.ind = TRUE)
high_correlation_values <- matrix[high_correlation_indices]
row_names <- rownames(matrix)[high_correlation_indices[, 1]]
col_names <- colnames(matrix)[high_correlation_indices[, 2]]
result_df <- data.frame(
  Row = row_names,
  Column = col_names,
  Correlation = high_correlation_values
)
result_df <- result_df[order(-result_df$Correlation), ]
print(result_df)
```

As we can see above, there are multiple variables which are very strongly correlated. For example, Under_five_deaths and Infant_deaths have a near perfect correlation, with a covariance value of nearly one. 

Based on the above information, we created the reduced model coded below:

```{r reduced_model}
reg_2015_red <- lm(Life_expectancy~Adult_mortality
                     +Alcohol_consumption+Measles+BMI+
                     Diphtheria+Incidents_HIV+GDP_per_capita+Population_mln+
                     Thinness_ten_nineteen_years+Schooling+
                     as.factor(Economy_status_Developed), data=data.2015)
print(summary(reg_2015_red))
```

We can see based on the above that this model is still an incredibly good fit; the multiple R-squared value is still extremely close to 1 at 0.9552, and the p-value associated with the overall model is still extremely small. This model also has a significantly reduced amount of multicollinearity, as shown below:

```{r red_vif}
library(car)
print(vif(reg_2015_red))
```

All of the VIF values above are quite low, demonstrating that we have managed to reduced collinearity.

This reduced model also provides some different insights into the data. For example, alcohol consumption, Diphtheria, and Schooling now all have significant p-values associated with their coefficients. This could either be because they truly do have a significant relationship with life expectancy, which was masked in the full model, or because we removed too many variables and they are confounding the information we have above.

To determine whether we should use the full model or reduced model, we will perform an ANOVA test:

```{r anova}
anova(reg_2015_red, reg_2015, test = "F")
```

The output above tells us that, although we had initially seen that the reduced model is still a pretty good fit, our full model is in fact substantially better than the reduced model. The p-value associated with this ANOVA test is < 2.2e-16, which tells us there is a statistically significant difference in the performance of the two models. Further, we can see that the RSS associated with the reduced model is over twice the value of the full model (489.59 v. 239.52). Despite the good fit of the reduced model, we can therefore conclude based on this that the full model should give us more accurate results.

IV. Testing our Model on 2014 Data



